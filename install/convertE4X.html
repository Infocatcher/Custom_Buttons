<!DOCTYPE HTML>
<meta charset="utf-8"/>
<title>Convert E4X [0.1.0b1pre2 - 2013-02-17]</title>
<body>
<a href="custombutton://%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0D%0A%3Ccustombutton%20xmlns%3Acb%3D%22http%3A//xsms.nm.ru/custombuttons/%22%3E%0A%20%20%3Cname%3EConvert%20E4X%3C/name%3E%0A%20%20%3Cimage%3E%3C%21%5BCDATA%5Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABfVBMVEUAAADP6/KIzt9mZmbH6PCIzt+d1+XL6vGIzt+Izt94envb3t6ytLWmqKlvcnNqamqqqqqZmZlmZma+5O6w3urp9vlucnPLzMyq3OjE5+/o9vnm9fje39/k9Pih2Obu+PqIxduFxNvr9/q54uy34eye0eKQ0eGTl5jM6vFOp8n2+/3a8PWY1eN0dHTs9/qDxNoXjLiVzeB1vtY3nMKFn6istrkZjbmr3Oiy3+ry+vvv+ftAocXD5e7L6fG13up+wdlNp8ni8/fI1NhtcXKerrLP6/KJz9+S0uLF5++84+2l1eWc0uJcsc/x+fuGxNqp2ueh1eRrutRJpcjn9fkTibfh8veVmJm74+3I6fDR6/JmtNE6ncNEosaSyt6i0+OEjJDT2dyCg4SRlJTc3t+w3+qGh4jZ3d6M0OCeoKCEj5JVrMuv3OmBgoLf3+DExMWwsbF9wtmUlpev3umk2eaj2ebl9PjG5/CQy95tutQymsFPqsqLo6up2Oebn6Gbn6BsfygXAAAAE3RSTlMA8fHm8vJj6Ohj/v7+/v7m5uZzduGAygAAAMlJREFUeF6Fx1NzA1EYANBvuwjLe9eIbdupbdu28dvbTjLTvPW8HfifQd/VQW8AWnz8o47ScCznJvOWsJ2dl9Xa4uAQDI+sPLmsU2Mftsi4w3nghqCQmfCdT8/Mzt0s3N0/BEHDOP2MMX55fXv//MIaCAhFYwiheCKZOuKQAFmv96xQLJUrVU+90VzywHIgsLq2vrG55dve2d3b50CUfrCsJB0qPK+cnALlb7m4vLoOhW4pYHTEL6PJ3N1DEDoG2nr7+knoNEC2/w0LByhsb1WLGwAAAABJRU5ErkJggg%3D%3D%5D%5D%3E%3C/image%3E%0A%20%20%3Cmode%3E0%3C/mode%3E%0A%20%20%3Cinitcode%3E%3C%21%5BCDATA%5B/*Initialization%20Code*/%5D%5D%3E%3C/initcode%3E%0A%20%20%3Ccode%3E//%20https%3A//github.com/Infocatcher/Custom_Buttons/tree/master/Convert_E4X%0A//%20https%3A//forum.mozilla-russia.org/viewtopic.php%3Fid%3D56442%0A//%20http%3A//custombuttons.sf.net/forum/viewtopic.php%3Ff%3D2%26amp%3Bt%3D365%0A%0A//%20Convert%20E4X%20button%20for%20Custom%20Buttons%0A//%20Code%20for%20%22code%22%20section%0A%0A//%20%28c%29%20Infocatcher%202012-2013%0A//%20version%200.1.0b1pre2%20-%202013-02-17%0A%0A//%20Tries%20convert%20deprecated%20E4X%20to%20string%20literals.%0A//%20Click%20on%20button%20and%20then%20click%20on%20another%20button%20with%20E4X%20in%20code%20%28or%20click%20on%20opened%20page%20with%20*.js%20file%29.%0A%0Avar%20btn%20%3D%20this%3B%0Abtn.checked%20%3D%20true%3B%0AaddEventListener%28%22click%22%2C%20function%20getButton%28e%29%20%7B%0A%09var%20trg%20%3D%20e.target%3B%0A%0A%09var%20codes%3B%0A%09if%28trg.localName%20%3D%3D%20%22toolbarbutton%22%20%26amp%3B%26amp%3B%20/%5Ecustombuttons-button%5Cd+%24/.test%28trg.id%29%29%0A%09%09codes%20%3D%20%5Btrg.cbCommand%2C%20trg.cbInitCode%5D%3B%0A%09else%20if%28%0A%09%09trg.ownerDocument.defaultView%20%3D%3D%20content%0A%09%09%26amp%3B%26amp%3B%20/%5E%28%3F%3Aapplication%5C/%28%3F%3Ax-%29%3Fjavascript%7Ctext%5C/plain%29%24/.test%28trg.ownerDocument.contentType%29%0A%09%29%0A%09%09codes%20%3D%20%5Btrg.ownerDocument.body.textContent%5D%3B%0A%0A%09if%28%21codes%29%0A%09%09return%3B%0A%09removeEventListener%28e.type%2C%20getButton%2C%20true%29%3B%0A%09e.preventDefault%28%29%3B%0A%09e.stopPropagation%28%29%3B%0A%09btn.checked%20%3D%20false%3B%0A%09if%28trg%20%21%3D%20btn%29%0A%09%09codes.forEach%28convertCode%29%3B%0A%7D%2C%20true%29%3B%0A%0Afunction%20convertCode%28s%29%20%7B%0A%09if%28%21s%20%7C%7C%20s%20%3D%3D%20%22/*CODE*/%22%20%7C%7C%20s%20%3D%3D%20%22/*Initialization%20Code*/%22%29%0A%09%09return%3B%0A%09var%20orig%20%3D%20s%3B%0A%0A%09//%20Replace%20old%20parsers%0A%09//%20Note%3A%20declarations%20of%20old%20perser%20functions%20aren%27t%20removed%21%0A%09s%20%3D%20s.replace%28/%28%3F%3A%5B%5Cw%24%5D+%5Cs*%5C.%5Cs*%29*%28%3F%3AmakeXML%7CparseFromXML%29%28%5Cs*%29%5C%28/g%2C%20%22e4xConv_parseXULFromString%241%28%22%29%3B%0A%0A%09//%20Convert%20node.@attr%20%3D%20...%0A%09s%20%3D%20s.replace%28/%28%5C.%5Cs*%29@%28%5B%5Cw%24%5D+%29%5Cs*%3D%5Cs*%28%5B%5E%3B%5D+%29/g%2C%20%27%241setAttribute%28%22%242%22%2C%20%243%29%27%29%3B%0A%0A%09//%20Other%20node.@attr%20usage%0A%09s%20%3D%20s.replace%28/%28%5C.%5Cs*%29@%28%5B%5Cw%24%5D+%29/g%2C%20%27%241getAttribute%28%22%242%22%29%27%29%3B%0A%0A%09s%20%3D%20s%0A%09%09//%20%26lt%3B%26gt%3B%20...%20%26lt%3B/%26gt%3B%0A%09%09.replace%28/%26lt%3B%26gt%3B%28%5B%5Cs%5CS%5D+%3F%29%26lt%3B%5C/%26gt%3B%28%3F%3A%5Cs*%5C.%5Cs*toXMLString%5Cs*%5C%28%5C%29%29%3F/g%2C%20function%28s%2C%20e4x%29%20%7B%0A%09%09%09if%28e4x.substr%280%2C%209%29%20%3D%3D%20%22%26lt%3B%21%5BCDATA%5B%22%29%0A%09%09%09%09return%20s%3B%0A%09%09%09LOG%28%22%26lt%3B%26gt%3B%20...%20%26lt%3B/%26gt%3B%5Cn%22%20+%20s%29%3B%0A%09%09%09return%20convertE4X%28e4x%29%3B%0A%09%09%7D%29%0A%09%09//%20%26lt%3B%21%5BCDATA%5B%20...%20%5D%5D%26gt%3B%0A%09%09.replace%28/%28%3F%3A%26lt%3B%26gt%3B%29%3F%26lt%3B%21%5C%5BCDATA%5C%5B%28%5B%5Cs%5CS%5D+%3F%29%5C%5D%5C%5D%26gt%3B%28%3F%3A%26lt%3B%5C/%26gt%3B%29%3F%28%3F%3A%5Cs*%5C.%5Cs*toString%5Cs*%5C%28%5C%29%29%3F/g%2C%20function%28s%2C%20cdata%29%20%7B%0A%09%09%09if%28inE4X%28RegExp.leftContext%29%20%7C%7C%20alreadyConverted%28cdata%29%29%0A%09%09%09%09return%20s%3B%0A%09%09%09LOG%28%22%26lt%3B%21%5BCDATA%5B%20...%20%5D%5D%26gt%3B%5Cn%22%20+%20s%29%3B%0A%09%09%09return%20convertCDATA%28cdata%29%3B%0A%09%09%7D%29%0A%09%09//%20%26lt%3Btag%20...%20/%26gt%3B%0A%09%09.replace%28/%26lt%3B%5Cw+%5Cs%28%5B%5E%26gt%3B%5D+%3F%29%5C/%26gt%3B%28%3F%3A%5Cs*%5C.%5Cs*toXMLString%5Cs*%5C%28%5C%29%29%3F/g%2C%20function%28s%29%20%7B%0A%09%09%09if%28inE4X%28RegExp.leftContext%29%20%7C%7C%20alreadyConverted%28s%29%20%7C%7C%20/%5E%28%3F%3A%5C%5Cn%29%3F%5C%5C%5B%5Cn%5Cr%5D/.test%28RegExp.rightContext%29%29%0A%09%09%09%09return%20s%3B%0A%09%09%09LOG%28%22%26lt%3Btag%20...%20/%26gt%3B%5Cn%22%20+%20s%29%3B%0A%09%09%09return%20convertE4X%28s%29%3B%0A%09%09%7D%29%0A%09%09//%20%26lt%3Btag%26gt%3B%20...%20%26lt%3B/tag%26gt%3B%0A%09%09//.replace%28/%26lt%3B%28%5Cw+%29%28%3F%3A%5B%5E%26gt%3B%5D*%5B%5E%26gt%3B%5C/%5D%29%3F%26gt%3B%28%5B%5Cs%5CS%5D*%3F%29%26lt%3B%5C/%5C1%26gt%3B%28%3F%3A%5Cs*%5C.%5Cs*toXMLString%5Cs*%5C%28%5C%29%29%3F/g%2C%20function%28s%29%20%7B%0A%09%09.replace%28getTagsPattern%28%29%2C%20function%28s%29%20%7B%0A%09%09%09if%28inE4X%28RegExp.leftContext%29%20%7C%7C%20alreadyConverted%28s%29%29%0A%09%09%09%09return%20s%3B%0A%09%09%09LOG%28%22%26lt%3Btag%26gt%3B%20...%20%26lt%3B/tag%26gt%3B%5Cn%22%20+%20s%29%3B%0A%09%09%09return%20convertE4X%28s%29%3B%0A%09%09%7D%29%0A%09%09//%20All%20.toXMLString%28%29%20calls%20are%20useless%0A%09%09//%20Example%3A%0A%09%09//%20window.openDialog%28%22data%3Aapplication/vnd.mozilla.xul+xml%2C%22%20+%20encodeURIComponent%28dialog.toXMLString%28%29%29%2C%20...%0A%09%09.replace%28/%5Cs*%5C.%5Cs*toXMLString%5Cs*%5C%28%5C%29/g%2C%20%22%22%29%3B%0A%0A%09if%28s%20%21%3D%20orig%29%20%7B%0A%09%09if%28/%5CWXML%5Cs*%5C.%5Cs*%5Cw/.test%28orig%29%29%20%7B%0A%09%09%09s%20%3D%20s.replace%28%0A%09%09%09%09/%5E%28%3F%3A%5C/%5C*%28%3F%3ACODE%7CInitialization%20Code%29%5C*%5C/%5Cn%3F%29%3F/%2C%0A%09%09%09%09%22%24%26amp%3Bvar%20XML%20%3D%20window.XML%20%7C%7C%20%7B%7D%3B%5Cn%5Cn%22%0A%09%09%09%29%3B%0A%09%09%7D%0A%09%09var%20addFuncs%20%3D%20%22%22%3B%0A%09%09if%28s.indexOf%28%22e4xConv_parseXULFromString%22%29%20%21%3D%20-1%29%0A%09%09%09addFuncs%20+%3D%20%22%5Cn%22%20+%20e4xConv_parseXULFromString%3B%0A%09%09if%28s.indexOf%28%22e4xConv_encodeHTML%22%29%20%21%3D%20-1%29%0A%09%09%09addFuncs%20+%3D%20%22%5Cn%22%20+%20e4xConv_encodeHTML%3B%0A%09%09if%28addFuncs%29%0A%09%09%09s%20+%3D%20%22%5Cn%22%20+%20addFuncs%3B%0A%09%09out%28s%29%3B%0A%09%7D%0A%7D%0Afunction%20getTagsPattern%28%29%20%7B%0A%09//%20I%27m%20too%20lazy%20to%20write%20a%20real%20tags%20parser%2C%20sorry...%0A%09const%20recursion%20%3D%207%3B%0A%09const%20tagStart%20%3D%20%22%26lt%3B%28%5C%5Cw+%29%28%3F%3A%5B%5E%26gt%3B%5D*%5B%5E%26gt%3B%5C%5C/%5D%29%3F%26gt%3B%22%3B%0A%0A%09function%20getSub%28level%29%20%7B%0A%09%09if%28++level%20%26gt%3B%20recursion%29%0A%09%09%09return%20%22%5B%5C%5Cs%5C%5CS%5D*%3F%22%3B%0A%09%09return%20%22%28%3F%3A%22%0A%09%09%09+%20%22%26lt%3B%5C%5Cw+%5B%5E%26gt%3B%5D*%5C%5C/%26gt%3B%22%0A%09%09%09+%20%22%7C%22%20+%20tagStart%20+%20getSub%28level%29%20+%20%22%26lt%3B%5C%5C/%5C%5C%22%20+%20level%20+%20%22%26gt%3B%22%0A%09%09%09+%20%22%7C%5B%5C%5Cs%5C%5CS%5D%22%0A%09%09%09+%20%22%29*%3F%22%3B%0A%09%7D%0A%09var%20pattern%20%3D%20tagStart%0A%09%09+%20getSub%281%29%0A%09%09+%20%22%26lt%3B%5C%5C/%5C%5C1%26gt%3B%22%0A%09%09+%20%22%28%3F%3A%5C%5Cs*%5C%5C.%5C%5Cs*toXMLString%5C%5Cs*%5C%5C%28%5C%5C%29%29%3F%22%3B%0A%0A%09var%20re%20%3D%20new%20RegExp%28pattern%2C%20%22g%22%29%3B%0A%09getTagsPattern%20%3D%20function%28%29%20%7B%0A%09%09return%20re%3B%0A%09%7D%3B%0A%09return%20re%3B%0A%7D%0Afunction%20convertCDATA%28s%29%20%7B%0A%09return%20%22%27%22%20+%20escapeString%28s.replace%28/%5B%27%5C%5C%5D/g%2C%20%22%5C%5C%24%26amp%3B%22%29%29%20+%20%22%27%22%3B%0A%7D%0Afunction%20inE4X%28prev%29%20%7B%0A%09return%20/%26gt%3B%5Cs*%28%3F%3A%28%3F%3A%5C%5Cn%29%3F%5C%5C%5B%5Cn%5Cr%5D%5Cs*%29%3F%24/.test%28prev%29%3B%0A%7D%0Afunction%20alreadyConverted%28s%29%20%7B%0A%09return%20/%5B%27%22%26gt%3B%5D%5B%20%5Ct%5D*%28%3F%3A%5C%5Cn%29%3F%5C%5C%5B%5Cn%5Cr%5D/.test%28s%29%3B%0A%7D%0Afunction%20convertE4X%28s%29%20%7B%0A%09var%20cdates%20%3D%20%5B%5D%3B%0A%09var%20rndCd%20%3D%20rnd%28%29%3B%0A%09//%20Leave%20CDATA%20as%20is%0A%09s%20%3D%20s.replace%28/%26lt%3B%21%5C%5BCDATA%5C%5B%5B%5Cs%5CS%5D+%3F%5C%5D%5C%5D%26gt%3B/g%2C%20function%28s%29%20%7B%0A%09%09//cdates.push%28%22%5C%5Cx3%22%20+%20s.substr%281%29%29%3B%20//%20Very%20simple%20way%20to%20break%20CDATA%0A%09%09cdates.push%28s%29%3B%0A%09%09return%20rndCd%3B%0A%09%7D%29%3B%0A%0A%09//%20Extract%20codes%0A%09var%20codes%20%3D%20%5B%5D%3B%0A%09var%20rndExpr%20%3D%20rnd%28%29%3B%0A%09//%20%7B%20expressions%20%7D%0A%09s%20%3D%20s.replace%28/%28%3D%5Cs*%29%3F%5C%7B%28%5B%5E%5C%7D%5D*%29%5C%7D/g%2C%20function%28s%2C%20eq%2C%20code%29%20%7B%0A%09%09//%7E%20todo%3A%20don%27t%20add%20%28%20...%20%29%20for%20foo%2C%20this.foo%2C%20this%5Bfoo%5D%20and%20foo%28%22something%22%29%20%3F%0A%09%09var%20isAttr%20%3D%20%21%21RegExp.%241%3B%0A%09%09code%20%3D%20%22e4xConv_encodeHTML%28%22%20+%20code%20+%20%28isAttr%20%3F%20%22%2C%20true%22%20%3A%20%22%22%29%20+%20%22%29%22%3B%0A%09%09var%20q%20%3D%20eq%20%3F%20%27%22%27%20%3A%20%22%22%3B%0A%09%09code%20%3D%20q%20+%20%22%27%20+%20%22%20+%20code%20+%20%22%20+%20%27%22%20+%20q%3B%0A%09%09codes.push%28code%29%3B%0A%09%09return%20eq%20+%20rndExpr%3B%0A%09%7D%29%3B%0A%0A%09//%20Restore%20CDATA%0A%09var%20i%20%3D%200%3B%0A%09s%20%3D%20s.replace%28new%20RegExp%28rndCd%2C%20%22g%22%29%2C%20function%28s%29%20%7B%0A%09%09return%20cdates%5Bi++%5D%3B%0A%09%7D%29%3B%0A%0A%09s%20%3D%20escapeString%28s%29%3B%0A%0A%09//%20Restore%20codes%0A%09var%20i%20%3D%200%3B%0A%09s%20%3D%20s.replace%28new%20RegExp%28rndExpr%2C%20%22g%22%29%2C%20function%28s%29%20%7B%0A%09%09return%20codes%5Bi++%5D%3B%0A%09%7D%29%3B%0A%09return%20%22%27%22%20+%20s%20+%20%22%27%22%3B%0A%7D%0Afunction%20escapeString%28s%29%20%7B%0A%09return%20s%0A%09%09.replace%28/%5B%27%5C%5C%5D/g%2C%20%22%5C%5C%24%26amp%3B%22%29%0A%09%09.replace%28/%24/mg%2C%20%22%5C%5Cn%5C%5C%22%29%0A%09%09.replace%28/%5E%5C%5Cn%28%5C%5C%5B%5Cn%5Cr%5D%29/%2C%20%22%241%22%29%0A%09%09.slice%280%2C%20-3%29%3B%0A%7D%0Afunction%20rnd%28%29%20%7B%0A%09return%20Date.now%28%29%0A%09%09+%20Math.random%28%29.toFixed%2814%29.substr%282%29%0A%09%09+%20Math.random%28%29.toFixed%2814%29.substr%282%29%3B%0A%7D%0Afunction%20out%28s%29%20%7B%0A%09var%20uri%20%3D%20%22data%3Atext/plain%3Bcharset%3Dutf-8%2C%22%20+%20encodeURIComponent%28s%29%3B%0A%09gBrowser.selectedTab%20%3D%20gBrowser.addTab%28uri%2C%20makeURI%28%22about%3Ablank%22%29%29%3B%0A%7D%0A%0Afunction%20e4xConv_parseXULFromString%28xul%29%20%7B%0A%09xul%20%3D%20xul.replace%28/%26gt%3B%5Cs+%26lt%3B/g%2C%20%22%26gt%3B%26lt%3B%22%29%3B%0A%09return%20new%20DOMParser%28%29.parseFromString%28xul%2C%20%22application/xml%22%29.documentElement%3B%0A%7D%0Afunction%20e4xConv_encodeHTML%28s%2C%20isAttr%29%20%7B%0A%09s%20%3D%20String%28s%29%0A%09%09.replace%28/%26amp%3B/g%2C%20%22%26amp%3Bamp%3B%22%29%0A%09%09.replace%28/%26lt%3B/g%2C%20%22%26amp%3Blt%3B%22%29%0A%09%09.replace%28/%26gt%3B/g%2C%20%22%26amp%3Bgt%3B%22%29%0A%09%09.replace%28/%22/g%2C%20%22%26amp%3Bquot%3B%22%29%3B%0A%09if%28isAttr%29%20%7B%0A%09%09s%20%3D%20s%0A%09%09%09.replace%28/%5Ct/g%2C%20%22%26amp%3B%23x9%3B%22%29%0A%09%09%09.replace%28/%5Cn/g%2C%20%22%26amp%3B%23xA%3B%22%29%0A%09%09%09.replace%28/%5Cr/g%2C%20%22%26amp%3B%23xD%3B%22%29%3B%0A%09%7D%0A%09return%20s%3B%0A%7D%3C/code%3E%0A%20%20%3Caccelkey%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/accelkey%3E%0A%20%20%3Chelp%3E%3C%21%5BCDATA%5BClick%20on%20this%20button%20and%20then%20click%20on%20broken%20button%20with%20E4X%20in%20code%20%28or%20click%20on%20opened%20page%20with%20*.js%20file%29.%0AWill%20be%20opened%20one%20or%20two%20tabs%20%28%22code%22/%22initialization%22%29%20with%20corrected%20code.%5D%5D%3E%3C/help%3E%0A%20%20%3Cattributes/%3E%0A%3C/custombutton%3E"
>Install</a>
| <a href="https://github.com/Infocatcher/Custom_Buttons/tree/master/Convert_E4X">Source</a>
<script type="text/javascript">
var a = document.getElementsByTagName("a")[0];
a.title = document.title;
if(/%3Cimage%3E%3C%21%5BCDATA%5B(data%3A\S+)%5D%5D%3E%3C\/image%3E/.test(a.href)) {
	var icon = decodeURIComponent(RegExp.$1);

	var img = document.createElement("img");
	img.src = icon;
	img.alt = "";
	img.style.verticalAlign = "middle";
	img.style.marginRight = "4px";
	a.insertBefore(img, a.firstChild);

	var link = document.createElement("link");
	link.rel = "shortcut icon";
	link.href = icon;
	document.documentElement.insertBefore(link, document.documentElement.firstChild);
}
</script>
<script type="text/javascript" src="http://infocatcher.github.io/Custom_Buttons/viewCustomButton.js"></script>
<script type="text/javascript">
if("viewCustomButtonCode" in window) setTimeout(function() {
	viewCustomButtonCode(a.href);
}, 0);
</script>
</body>
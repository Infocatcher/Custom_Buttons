<!DOCTYPE HTML>
<meta charset="utf-8"/>
<title>Custom Buttons Editor: Toggle on Top [0.1.12pre - 2019-12-22]</title>
<body>
<a href="custombutton://%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0D%0A%3Ccustombutton%20xmlns%3Acb%3D%22http%3A//xsms.nm.ru/custombuttons/%22%3E%0A%20%20%3Cname%3ECustom%20Buttons%20Editor%3A%20Toggle%20on%20Top%3C/name%3E%0A%20%20%3Cimage%3E%3C%21%5BCDATA%5Bdata%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAidJREFUeNqkU01oE1EYnP2JkOAPHrwUXBBERCII8ShoxNIWU0SaXnrpzYuHCnoR4kHx3hoQKkWxly4tPVnEQJJDCajYhjY5BKkBwZBgKN3Y1JAmm911Nm7MjwkeXBi+7HvfzDdv9kWwLAv/88gFUfxr0ZYUupeuEDMGEC4Bie98yXFwnVUcpGx0v84MqWqwBtyn+NXOjYECZvdvEfk8zoTDt6rAQ4pc/6dAp32dffWDA+RjMZyamBjZt6wnFB2xN4W88Oe0j4kLRI2bxQawfQT42rS/sBDcW19HsVDAcbcbRz0eqCsrSTq5LO+0v8LNa8vLPuRyhl4qlfe3tvI/Eonc2dnZMZt8aBjYjsc/8AgSw5PICjUdxNtWRzn56Y3FRZ+RTuNQ12Fwms6pNvnt0tImXT2SgUijX4hUjDD50Lvp6aSlKPi5u4tiKoW9chmfVlc/mg65NyDJTiBFpH/XLFF3RSKnFb9/SMtmYVSrEFyuRlnTPrNlQ+j4Ql/sIwjtEMFbeYxlKhqNzmvDw8lL4+M+qVKBJQiVWDz+hi6nWr1zxI59E7vcCMJoJpOZ83q9oduiqNXW1jAWDPpgmm5OVVqNzxxy87EdiLzOhF9V1Q1Zlu8QJ4Nce81gXwKb2uSk9ZyVwLl+N0WSpIuBQOAViQEKSa3188QDisyTfA940Y9sB6CQeNc0zffEN+dv0OiB3lMbTp9hC5wgPI6Y5YTcqqbTaA7CLwEGADeU6xwv9+FCAAAAAElFTkSuQmCC%5D%5D%3E%3C/image%3E%0A%20%20%3Cmode%3E0%3C/mode%3E%0A%20%20%3Cinitcode%3E%3C%21%5BCDATA%5B//%20https%3A//forum.mozilla-russia.org/viewtopic.php%3Fid%3D56040%0A//%20http%3A//infocatcher.ucoz.net/js/cb/cbEditorToggleOnTop.js%0A//%20https%3A//github.com/Infocatcher/Custom_Buttons/tree/master/CB_Editor_Toggle_on_Top%0A%0A//%20Custom%20Buttons%20Editor%3A%20Toggle%20on%20Top%20button%20for%20Custom%20Buttons%0A//%20%28code%20for%20%22initialization%22%20section%29%0A%0A//%20%28c%29%20Infocatcher%202012-2019%0A//%20version%200.1.12pre%20-%202019-12-22%0A%0A//%20Hotkey%3A%20Ctrl+T%0A%0Aconst%20watcherId%20%3D%20%22customButtonsToggleOnTop_%22%20+%20this.id%3B%0Avar%20%7BComponents%7D%20%3D%20window%3B%20//%20Prevent%20garbage%20collection%20in%20Firefox%203.6%20and%20older%0Avar%20storage%20%3D%20%28function%28%29%20%7B%0A%09if%28%21%28%22Services%22%20in%20window%29%29%20//%20Firefox%203.6%20and%20older%0A%09%09return%20Application.storage%3B%0A%09//%20Simple%20replacement%20for%20Application.storage%0A%09//%20See%20https%3A//bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1090880%0A%09//var%20global%20%3D%20Components.utils.getGlobalForObject%28Services%29%3B%0A%09//%20Ensure%2C%20that%20we%20have%20global%20object%20%28because%20window.Services%20may%20be%20overwritten%29%0A%09var%20global%20%3D%20Components.utils.import%28%22resource%3A//gre/modules/Services.jsm%22%2C%20%7B%7D%29%3B%0A%09var%20ns%20%3D%20%22_cbEditorToggleOnTopStorage%22%3B%0A%09//%20Note%3A%20Firefox%2057+%20returns%20NonSyntacticVariablesObject%20w/o%20.Object%20property%0A%09var%20storage%20%3D%20global%5Bns%5D%20%7C%7C%20%28global%5Bns%5D%20%3D%20Components.utils.getGlobalForObject%28global%29.Object.create%28null%29%29%3B%0A%09return%20%7B%0A%09%09get%3A%20function%28key%2C%20defaultVal%29%20%7B%0A%09%09%09if%28key%20in%20storage%29%0A%09%09%09%09return%20storage%5Bkey%5D%3B%0A%09%09%09return%20defaultVal%3B%0A%09%09%7D%2C%0A%09%09set%3A%20function%28key%2C%20val%29%20%7B%0A%09%09%09if%28key%20%3D%3D%3D%20null%29%0A%09%09%09%09delete%20storage%5Bkey%5D%3B%0A%09%09%09else%0A%09%09%09%09storage%5Bkey%5D%20%3D%20val%3B%0A%09%09%7D%0A%09%7D%3B%0A%7D%29%28%29%3B%0Avar%20watcher%20%3D%20storage.get%28watcherId%2C%20null%29%3B%0Aif%28%21watcher%29%20%7B%0A%09watcher%20%3D%20%7B%0A%09%09btnPos%3A%200%2C%20//%200%20-%20at%20top%20right%20window%20corner%2C%201%20-%20at%20end%20of%20tabs%2C%202%20-%20before%20dialog%20buttons%20spacer%0A%09%09btnStyle%3A%20%22button%22%2C%20//%20%22button%22%20or%20%22toolbarbutton%22%0A%09%09btnChecked%3A%20true%2C%20//%20use%20%22checked%22%20style%3A%20true%20or%20false%0A%0A%09%09//%20Fogue%20icons%2C%20http%3A//p.yusukekamiyamane.com/%0A%09%09//%20http%3A//www.iconfinder.com/icondetails/12276/16/gps_location_pin_icon%0A%09%09icon%3A%20%22data%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3AgNBjAx4SevkwAAAjxJREFUKM+FUk1oE0EU/mZnRU0U6cFLIT1KKkkNpIcSWwUvVty2l142hZpDoQcPgYQKQkUEz6V6sHgR/KGQQwleQg/xEKRRsIEmga4NoZa2oRGKpJaWmp2Z52UX12Dxg4838+D73ps3jzUYQycIgDc7l0oNAkgqpZ4n5uc/NgHsEEHDKZB/X5OJRGJcSplemJ6+6SZPFStvJ0Ta4eEhTNMcE0I8fDsxcQsAdPwHc6nUoBRCOz4+Rr1eR39//+18Pn/h/cjIGea+eS6VegLgKoBfRPRdKbXGOf8GIBmPx8cty0Kz2YTf74ff70cmkynpNSIAwP7+/t2ZmZnowcGBPDo6+rm1tdWo1Wo7pmnesSwLtm2jWCx+EkJwKSUnoln2wWnv9eTkMBE9TafT0b29PbTbbXDO0Wq1YNs2lpaWVpVSj8ZyuWXhaPg953CtXK6v9fVtr6ys9A4NDXU3Gg24JoVC4fPJycnjsVxu2TtMzgCUAVQAUKVSrwDtzc3NQCQS6d7d3XU7EK1W62twY+ML84i1N4zB5TvgYrVaPTs1NRXNZDKlrq4u+Hw+BAKBy1LK6zYA2xE+6/gqzhgbXl9fnw+FQrPBYPCHlBKjo6NRIjpPRD3kEdbcJWGMgTF2Y3Fx8UE4HE4yxl70WtYCEc1ms9kS51wDcM4r/FOS87BhGK90XTc0TeNuPgggFosNG4axOjAw8PJKxwIxAD26rt9XShWVUtvOWosO2h1RAJAMwCUAPseInGG6UTlm6l/8DZ+nFuAjSdH0AAAAAElFTkSuQmCC%22%2C%0A%09%09iconPinned%3A%20%22data%3Aimage/png%3Bbase64%2CiVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3AgNBjIpwH1VRwAAAgdJREFUKM+FkkFoU0EQhr/dtxFSquLBS8CAICISQci1oBWLKaaINL300psXDxH0ItSD4L21UKgUxV4aWnKyiIGaQwio2IQ0PQQpBaEhoaEk0dSQNsnb9WAepg+LPwz/7DD/7O7MiJIQuGEAV3QIiNowV4f0HlA0BskJsI8fo75YLHIEjw3ccIInivVxX1IqcXFu7l4Lnhq4BaD4P4Y6INsHB+zlcpwfH7+zG48PavCIvj8/B64CRxoqXdg8Bd+BqG9xMVJNpaiUy5zxehkcGCC2uppV28Y44rs3V1aCFIt2p15v/MzlSj/S6eKlmZnRairFoW2zmUx+boHVBsvAtEj+fV5Iw4vbS0tBe2uLw04H2+ulUy5zaNu8X17OdOGZgkTX3TADCRumP0xNZY3fz6/9fSr5PNVGg6/x+BfdE/Y3wxJAHtj6wzt5aHsSiQv+4WFfbWcHu9VCeDzdRq32DdgQfZMQom9JjDGngcn19fWF2shI9vrYWNBqNjFCND8mk+8MTDq5s65RWUKIUKFQmA0EAtP3pawdra0xGokE0dqrwe8kvgS2e1cjpURKORyLxTaUUg+UUuciUvIWQq8hU5uYMPOQmQcuu7fAsqxr4XD4jVIqLKW0nPgV4AmEFiDzCF65hQLwK6Ueaq0/aa13e2vddVnHxV3AFsBZYKBXyPSa6bDuFdP/st/BfOD54p3eIQAAAABJRU5ErkJggg%3D%3D%22%2C%0A%0A%09%09boxId%3A%20%22cbToggleOnTopBox%22%2C%0A%09%09btnId%3A%20%22cbToggleOnTopButton%22%2C%0A%09%09onTopAttr%3A%20%22cbOnTop%22%2C%0A%09%09naAttr%3A%20%22cbOnTopNA%22%2C%0A%09%09styleId%3A%20%22cbToggleOnTopStyle%22%2C%0A%09%09get%20btnTip%28%29%20%7B%0A%09%09%09var%20locale%20%3D%20%28function%28%29%20%7B%0A%09%09%09%09if%28%22Services%22%20in%20window%20%26%26%20%22locale%22%20in%20Services%29%20%7B%0A%09%09%09%09%09var%20locales%20%3D%20Services.locale.requestedLocales%20//%20Firefox%2064+%0A%09%09%09%09%09%09%7C%7C%20Services.locale.getRequestedLocales%20%26%26%20Services.locale.getRequestedLocales%28%29%3B%0A%09%09%09%09%09if%28locales%29%0A%09%09%09%09%09%09return%20locales%5B0%5D%3B%0A%09%09%09%09%7D%0A%09%09%09%09var%20prefs%20%3D%20%22Services%22%20in%20window%20%26%26%20Services.prefs%0A%09%09%09%09%09%7C%7C%20Components.classes%5B%22@mozilla.org/preferences-service%3B1%22%5D%0A%09%09%09%09%09%09.getService%28Components.interfaces.nsIPrefBranch%29%3B%0A%09%09%09%09function%20pref%28name%2C%20type%29%20%7B%0A%09%09%09%09%09return%20prefs.getPrefType%28name%29%20%21%3D%20prefs.PREF_INVALID%20%3F%20prefs%5B%22get%22%20+%20type%20+%20%22Pref%22%5D%28name%29%20%3A%20undefined%3B%0A%09%09%09%09%7D%0A%09%09%09%09if%28%21pref%28%22intl.locale.matchOS%22%2C%20%22Bool%22%29%29%20%7B%20//%20Also%20see%20https%3A//bugzilla.mozilla.org/show_bug.cgi%3Fid%3D1414390%0A%09%09%09%09%09var%20locale%20%3D%20pref%28%22general.useragent.locale%22%2C%20%22Char%22%29%3B%0A%09%09%09%09%09if%28locale%20%26%26%20locale.substr%280%2C%209%29%20%21%3D%20%22chrome%3A//%22%29%0A%09%09%09%09%09%09return%20locale%3B%0A%09%09%09%09%7D%0A%09%09%09%09return%20Components.classes%5B%22@mozilla.org/chrome/chrome-registry%3B1%22%5D%0A%09%09%09%09%09.getService%28Components.interfaces.nsIXULChromeRegistry%29%0A%09%09%09%09%09.getSelectedLocale%28%22global%22%29%3B%0A%09%09%09%7D%29%28%29.match%28/%5E%5Ba-z%5D*/%29%5B0%5D%3B%0A%09%09%09if%28locale%20%3D%3D%20%22ru%22%29%0A%09%09%09%09return%20%22%u041F%u043E%u0432%u0435%u0440%u0445%20%u0432%u0441%u0435%u0445%20%u043E%u043A%u043E%u043D%20%28Ctrl+T%29%22%3B%0A%09%09%09return%20%22Always%20on%20top%20%28Ctrl+T%29%22%3B%0A%09%09%7D%2C%0A%0A%09%09REASON_STARTUP%3A%201%2C%0A%09%09REASON_SHUTDOWN%3A%202%2C%0A%09%09REASON_WINDOW_LOADED%3A%203%2C%0A%09%09REASON_WINDOW_CLOSED%3A%204%2C%0A%0A%09%09get%20obs%28%29%20%7B%0A%09%09%09delete%20this.obs%3B%0A%09%09%09return%20this.obs%20%3D%20Components.classes%5B%22@mozilla.org/observer-service%3B1%22%5D%0A%09%09%09%09.getService%28Components.interfaces.nsIObserverService%29%3B%0A%09%09%7D%2C%0A%09%09get%20ww%28%29%20%7B%0A%09%09%09delete%20this.ww%3B%0A%09%09%09return%20this.ww%20%3D%20Components.classes%5B%22@mozilla.org/embedcomp/window-watcher%3B1%22%5D%0A%09%09%09%09.getService%28Components.interfaces.nsIWindowWatcher%29%3B%0A%09%09%7D%2C%0A%09%09get%20wm%28%29%20%7B%0A%09%09%09delete%20this.wm%3B%0A%09%09%09return%20this.wm%20%3D%20Components.classes%5B%22@mozilla.org/appshell/window-mediator%3B1%22%5D%0A%09%09%09%09.getService%28Components.interfaces.nsIWindowMediator%29%3B%0A%09%09%7D%2C%0A%09%09init%3A%20function%28reason%29%20%7B%0A%09%09%09this.obs.addObserver%28this%2C%20%22quit-application-granted%22%2C%20false%29%3B%0A%09%09%09var%20ws%20%3D%20this.wm.getEnumerator%28null%29%3B%0A%09%09%09while%28ws.hasMoreElements%28%29%29%0A%09%09%09%09this.initWindow%28ws.getNext%28%29%2C%20reason%29%3B%0A%09%09%09this.ww.registerNotification%28this%29%3B%0A%09%09%7D%2C%0A%09%09destroy%3A%20function%28reason%29%20%7B%0A%09%09%09this.obs.removeObserver%28this%2C%20%22quit-application-granted%22%29%3B%0A%09%09%09var%20ws%20%3D%20this.wm.getEnumerator%28null%29%3B%0A%09%09%09while%28ws.hasMoreElements%28%29%29%0A%09%09%09%09this.destroyWindow%28ws.getNext%28%29%2C%20reason%29%3B%0A%09%09%09this.ww.unregisterNotification%28this%29%3B%0A%09%09%7D%2C%0A%09%09initWindow%3A%20function%28window%2C%20reason%29%20%7B%0A%09%09%09if%28%21this.isTargetWindow%28window%29%29%0A%09%09%09%09return%3B%0A%09%09%09window.addEventListener%28%22keypress%22%2C%20this%2C%20true%29%3B%0A%09%09%09if%28this.hasSizeModeChangeEvent%29%0A%09%09%09%09window.addEventListener%28%22sizemodechange%22%2C%20this%2C%20false%29%3B%0A%09%09%09else%20%7B%0A%09%09%09%09window.addEventListener%28%22resize%22%2C%20this%2C%20false%29%3B%20//%20Can%20detect%20only%20maximize/restore%0A%09%09%09%09this.legacySizeModeChange%28window%29%3B%0A%09%09%09%7D%0A%09%09%09this.restoreOnTopAttr%28window%29%3B%0A%0A%09%09%09var%20document%20%3D%20window.document%3B%0A%09%09%09this.removeStyle%28document%29%3B%0A%09%09%09this.addStyle%28document%29%3B%0A%09%09%09var%20box%20%3D%20document.getElementById%28this.boxId%29%3B%0A%09%09%09box%20%26%26%20box.parentNode.removeChild%28box%29%3B%0A%09%09%09box%20%3D%20document.createElementNS%28xulns%2C%20%22hbox%22%29%3B%0A%09%09%09box.id%20%3D%20this.boxId%3B%0A%09%09%09var%20btn%20%3D%20document.createElementNS%28xulns%2C%20this.btnStyle%29%3B%0A%09%09%09btn.id%20%3D%20this.btnId%3B%0A%09%09%09if%28this.btnChecked%29%20%7B%0A%09%09%09%09btn.setAttribute%28%22type%22%2C%20%22checkbox%22%29%3B%0A%09%09%09%09btn.setAttribute%28%22autoCheck%22%2C%20%22false%22%29%3B%0A%09%09%09%7D%0A%09%09%09btn.tooltipText%20%3D%20this.btnTip%3B%0A%09%09%09btn.addEventListener%28%22command%22%2C%20this%2C%20false%29%3B%0A%09%09%09box.appendChild%28btn%29%3B%0A%09%09%09switch%28this.btnPos%29%20%7B%0A%09%09%09%09default%3A%0A%09%09%09%09%09box.setAttribute%28%22cbOnTopFloat%22%2C%20%22true%22%29%3B%0A%09%09%09%09%09document.documentElement.appendChild%28box%29%3B%0A%09%09%09%09break%3B%0A%09%09%09%09case%201%3A%0A%09%09%09%09%09box.setAttribute%28%22align%22%2C%20%22right%22%29%3B%0A%09%09%09%09%09let%20tabbox%20%3D%20document.getElementById%28%22custombuttons-editbutton-tabbox%22%29%3B%0A%09%09%09%09%09let%20tabs%20%3D%20tabbox.getElementsByTagName%28%22tabs%22%29%5B0%5D%3B%0A%09%09%09%09%09tabs.parentNode.insertBefore%28box%2C%20tabs%29%3B%0A%09%09%09%09%09box.style.marginBottom%20%3D%20-%28btn.boxObject%20%7C%7C%20btn.getBoundingClientRect%28%29%29.height%20+%20%22px%22%3B%0A%09%09%09%09break%3B%0A%09%09%09%09case%202%3A%0A%09%09%09%09%09box.setAttribute%28%22align%22%2C%20%22center%22%29%3B%0A%09%09%09%09%09let%20btnBox%20%3D%20document.documentElement.getButton%28%22accept%22%29.parentNode%3B%0A%09%09%09%09%09let%20insPos%20%3D%20btnBox.firstChild%3B%0A%09%09%09%09%09for%28let%20node%20%3D%20insPos%3B%20node%3B%20node%20%3D%20node.nextSibling%29%20%7B%0A%09%09%09%09%09%09if%28node.localName%20%3D%3D%20%22spacer%22%29%20%7B%0A%09%09%09%09%09%09%09insPos%20%3D%20node%3B%0A%09%09%09%09%09%09%09break%3B%0A%09%09%09%09%09%09%7D%0A%09%09%09%09%09%7D%0A%09%09%09%09%09btnBox.insertBefore%28box%2C%20insPos%29%3B%0A%09%09%09%7D%0A%09%09%09this.checkWindowStatus%28window%2C%20box%29%3B%0A%09%09%09//this.setOnTop%28btn%29%3B%0A%09%09%7D%2C%0A%09%09destroyWindow%3A%20function%28window%2C%20reason%29%20%7B%0A%09%09%09if%28reason%20%3D%3D%20this.REASON_WINDOW_CLOSED%29%0A%09%09%09%09window.removeEventListener%28%22DOMContentLoaded%22%2C%20this%2C%20false%29%3B%20//%20Window%20can%20be%20closed%20before%20DOMContentLoaded%0A%09%09%09if%28%21this.isTargetWindow%28window%29%29%0A%09%09%09%09return%3B%0A%09%09%09window.removeEventListener%28%22keypress%22%2C%20this%2C%20true%29%3B%0A%09%09%09if%28this.hasSizeModeChangeEvent%29%0A%09%09%09%09window.removeEventListener%28%22sizemodechange%22%2C%20this%2C%20false%29%3B%0A%09%09%09else%0A%09%09%09%09window.removeEventListener%28%22resize%22%2C%20this%2C%20false%29%3B%0A%09%09%09var%20document%20%3D%20window.document%3B%0A%09%09%09var%20btn%20%3D%20this.shadow%28document%29.getElementById%28this.btnId%29%3B%0A%09%09%09btn.removeEventListener%28%22command%22%2C%20this%2C%20false%29%3B%0A%09%09%09if%28reason%20%3D%3D%20this.REASON_SHUTDOWN%29%20%7B%0A%09%09%09%09let%20box%20%3D%20btn.parentNode%3B%0A%09%09%09%09box.parentNode.removeChild%28box%29%3B%0A%09%09%09%09this.removeStyle%28document%29%3B%0A%09%09%09%09let%20xulWin%20%3D%20this.getXulWin%28window%29%3B%0A%09%09%09%09xulWin.zLevel%20%3D%20xulWin.normalZ%3B%0A%09%09%09%7D%0A%09%09%7D%2C%0A%09%09isTargetWindow%3A%20function%28window%29%20%7B%0A%09%09%09return%20window.location.href.substr%280%2C%2041%29%20%3D%3D%20%22chrome%3A//custombuttons/content/editor.xul%22%3B%0A%09%09%7D%2C%0A%09%09observe%3A%20function%28subject%2C%20topic%2C%20data%29%20%7B%0A%09%09%09if%28topic%20%3D%3D%20%22quit-application-granted%22%29%0A%09%09%09%09this.destroy%28%29%3B%0A%09%09%09else%20if%28topic%20%3D%3D%20%22domwindowopened%22%29%0A%09%09%09%09subject.addEventListener%28%22DOMContentLoaded%22%2C%20this%2C%20false%29%3B%0A%09%09%09else%20if%28topic%20%3D%3D%20%22domwindowclosed%22%29%0A%09%09%09%09this.destroyWindow%28subject%2C%20this.REASON_WINDOW_CLOSED%29%3B%0A%09%09%7D%2C%0A%09%09handleEvent%3A%20function%28e%29%20%7B%0A%09%09%09var%20trg%20%3D%20e.originalTarget%20%7C%7C%20e.target%3B%0A%09%09%09var%20window%3B%0A%09%09%09switch%28e.type%29%20%7B%0A%09%09%09%09case%20%22DOMContentLoaded%22%3A%0A%09%09%09%09%09window%20%3D%20trg.defaultView%3B%0A%09%09%09%09%09window.removeEventListener%28%22DOMContentLoaded%22%2C%20this%2C%20false%29%3B%0A%09%09%09%09%09this.initWindow%28window%2C%20this.REASON_WINDOW_LOADED%29%3B%0A%09%09%09%09break%3B%0A%09%09%09%09case%20%22keypress%22%3A%0A%09%09%09%09%09if%28%0A%09%09%09%09%09%09%21%28%0A%09%09%09%09%09%09%09%28e.ctrlKey%20%7C%7C%20e.metaKey%29%20%26%26%20%21e.altKey%20%26%26%20%21e.shiftKey%0A%09%09%09%09%09%09%09%26%26%20String.fromCharCode%28e.charCode%29.toLowerCase%28%29%20%3D%3D%20%22t%22%0A%09%09%09%09%09%09%29%0A%09%09%09%09%09%29%0A%09%09%09%09%09%09break%3B%0A%09%09%09%09%09e.preventDefault%28%29%3B%0A%09%09%09%09%09e.stopPropagation%28%29%3B%0A%09%09%09%09case%20%22command%22%3A%0A%09%09%09%09%09window%20%3D%20trg.ownerDocument.defaultView.top%3B%0A%09%09%09%09%09this.toggleOnTop%28window%29%3B%0A%09%09%09%09break%3B%0A%09%09%09%09case%20%22sizemodechange%22%3A%0A%09%09%09%09case%20%22resize%22%3A%0A%09%09%09%09%09window%20%3D%20trg%3B%0A%09%09%09%09%09this.checkWindowStatus%28window%29%3B%0A%09%09%09%7D%0A%09%09%7D%2C%0A%09%09get%20platformVersion%28%29%20%7B%0A%09%09%09var%20appinfo%20%3D%20%22Services%22%20in%20window%20%26%26%20Services.appinfo%3B%0A%09%09%09delete%20this.platformVersion%3B%0A%09%09%09return%20this.platformVersion%20%3D%20appinfo%20%26%26%20parseFloat%28appinfo.platformVersion%29%3B%0A%09%09%7D%2C%0A%09%09get%20hasSizeModeChangeEvent%28%29%20%7B%0A%09%09%09var%20appinfo%20%3D%20%22Services%22%20in%20window%20%26%26%20Services.appinfo%3B%0A%09%09%09delete%20this.hasSizeModeChangeEvent%3B%0A%09%09%09return%20this.hasSizeModeChangeEvent%20%3D%20appinfo%20%26%26%20%28%0A%09%09%09%09appinfo.name%20%3D%3D%20%22Pale%20Moon%22%0A%09%09%09%09%7C%7C%20this.platformVersion%20%3E%3D%208%0A%09%09%09%29%3B%0A%09%09%7D%2C%0A%09%09legacySizeModeChange%3A%20function%28window%29%20%7B%0A%09%09%09var%20lastState%20%3D%20window.windowState%3B%0A%09%09%09window.setInterval%28function%28window%2C%20_this%29%20%7B%0A%09%09%09%09var%20state%20%3D%20window.windowState%3B%0A%09%09%09%09if%28state%20%21%3D%20lastState%29%0A%09%09%09%09%09_this.checkWindowStatus%28window%29%3B%0A%09%09%09%09lastState%20%3D%20state%3B%0A%09%09%09%7D%2C%20150%2C%20window%2C%20this%29%3B%0A%09%09%7D%2C%0A%09%09restoreOnTopAttr%3A%20function%28win%29%20%7B%0A%09%09%09var%20xs%20%3D%20this.platformVersion%20%3E%3D%2071%0A%09%09%09%09%26%26%20%22Services%22%20in%20window%20%26%26%20Services.xulStore%3B%0A%09%09%09if%28%21xs%29%0A%09%09%09%09return%20this.restoreOnTopAttr%20%3D%20function%28%29%20%7B%7D%3B%0A%09%09%09var%20attr%20%3D%20this.onTopAttr%3B%0A%09%09%09var%20id%20%3D%20win.document.documentElement.id%3B%0A%09%09%09return%20%28this.restoreOnTopAttr%20%3D%20function%28window%29%20%7B%0A%09%09%09%09var%20de%20%3D%20window.document.documentElement%3B%0A%09%09%09%09if%28de.hasAttribute%28attr%29%29%0A%09%09%09%09%09return%3B%0A%09%09%09%09var%20url%20%3D%20window.location.href%3B%0A%09%09%09%09if%28xs.hasValue%28url%2C%20id%2C%20attr%29%29%0A%09%09%09%09%09de.setAttribute%28attr%2C%20xs.getValue%28url%2C%20id%2C%20attr%29%29%3B%0A%09%09%09%7D%29%28win%29%3B%0A%09%09%7D%2C%0A%09%09checkWindowStatus%3A%20function%28window%2C%20box%29%20%7B%0A%09%09%09if%28%21box%29%0A%09%09%09%09box%20%3D%20this.shadow%28window.document%29.getElementById%28this.boxId%29%3B%0A%09%09%09var%20na%20%3D%20String%28window.windowState%20%21%3D%20window.STATE_NORMAL%29%3B%0A%09%09%09if%28box.getAttribute%28this.naAttr%29%20%3D%3D%20na%29%0A%09%09%09%09return%3B%0A%09%09%09box.setAttribute%28this.naAttr%2C%20na%29%3B%0A%09%09%09//LOG%28%22Set%20n/a%3A%20%22%20+%20na%29%3B%0A%09%09%09this.setOnTop%28box.firstChild%29%3B%0A%09%09%7D%2C%0A%09%09addStyle%3A%20function%28document%29%20%7B%0A%09%09%09var%20style%20%3D%20%27%5C%0A%09%09%09%09%25box%25%5BcbOnTopFloat%5D%20%7B%5Cn%5C%0A%09%09%09%09%09display%3A%20block%20%21important%3B%5Cn%5C%0A%09%09%09%09%09position%3A%20fixed%20%21important%3B%5Cn%5C%0A%09%09%09%09%09top%3A%200%20%21important%3B%5Cn%5C%0A%09%09%09%09%09right%3A%200%20%21important%3B%5Cn%5C%0A%09%09%09%09%7D%5Cn%5C%0A%09%09%09%09%25btn%25%2C%20%25btn%25%20*%20%7B%5Cn%5C%0A%09%09%09%09%09margin%3A%200%20%21important%3B%5Cn%5C%0A%09%09%09%09%09padding%3A%200%20%21important%3B%5Cn%5C%0A%09%09%09%09%7D%5Cn%5C%0A%09%09%09%09%25btn%25%20%3E%20.button-box%20%3E%20.button-icon%20%7B%5Cn%5C%0A%09%09%09%09%09margin%3A%20-3px%20-1px%20%21important%3B%5Cn%5C%0A%09%09%09%09%7D%5Cn%5C%0A%09%09%09%09toolbarbutton%25btn%25%20%7B%5Cn%5C%0A%09%09%09%09%09padding%3A%200%202px%20%21important%3B%5Cn%5C%0A%09%09%09%09%7D%5Cn%5C%0A%09%09%09%09%25btn%25%20%7B%5Cn%5C%0A%09%09%09%09%09position%3A%20relative%20%21important%3B%5Cn%5C%0A%09%09%09%09%09z-index%3A%202147483647%20%21important%3B%5Cn%5C%0A%09%09%09%09%09list-style-image%3A%20url%28%22%25icon%25%22%29%20%21important%3B%5Cn%5C%0A%09%09%09%09%09-moz-user-focus%3A%20ignore%20%21important%3B%5Cn%5C%0A%09%09%09%09%09min-height%3A%200%20%21important%3B%5Cn%5C%0A%09%09%09%09%09min-width%3A%200%20%21important%3B%5Cn%5C%0A%09%09%09%09%7D%5Cn%5C%0A%09%09%09%09%25btn%25%5B%25onTopAttr%25%3D%22true%22%5D%20%7B%5Cn%5C%0A%09%09%09%09%09list-style-image%3A%20url%28%22%25iconPinned%25%22%29%20%21important%3B%5Cn%5C%0A%09%09%09%09%7D%5Cn%5C%0A%09%09%09%09%25box%25%5B%25naAttr%25%3D%22true%22%5D%20image%20%7B%5Cn%5C%0A%09%09%09%09%09opacity%3A%200.75%20%21important%3B%5Cn%5C%0A%09%09%09%09%7D%27%0A%09%09%09%09.replace%28/%25box%25/g%2C%20%22%23%22%20+%20this.boxId%29%0A%09%09%09%09.replace%28/%25btn%25/g%2C%20%22%23%22%20+%20this.btnId%29%0A%09%09%09%09.replace%28/%25onTopAttr%25/g%2C%20this.onTopAttr%29%0A%09%09%09%09.replace%28/%25icon%25/g%2C%20this.icon%29%0A%09%09%09%09.replace%28/%25iconPinned%25/g%2C%20this.iconPinned%29%0A%09%09%09%09.replace%28/%25naAttr%25/g%2C%20this.naAttr%29%3B%0A%0A%09%09%09this.shadow%28document%2C%20style%29%20%7C%7C%20document.insertBefore%28document.createProcessingInstruction%28%0A%09%09%09%09%22xml-stylesheet%22%2C%0A%09%09%09%09%27id%3D%22%27%20+%20this.styleId%20+%20%27%22%20href%3D%22%27%20+%20%22data%3Atext/css%2C%22%0A%09%09%09%09%09+%20encodeURIComponent%28style%29%20+%20%27%22%20type%3D%22text/css%22%27%0A%09%09%09%29%2C%20document.documentElement%29%3B%0A%09%09%7D%2C%0A%09%09removeStyle%3A%20function%28document%29%20%7B%0A%09%09%09if%28this.shadow%28document%2C%20false%29%29%0A%09%09%09%09return%3B%0A%09%09%09var%20mark%20%3D%20%27id%3D%22%27%20+%20this.styleId%20+%20%27%22%27%3B%0A%09%09%09for%28var%20child%20%3D%20document.documentElement%3B%20child%20%3D%20child.previousSibling%3B%20%29%20%7B%0A%09%09%09%09if%28%0A%09%09%09%09%09child.nodeType%20%3D%3D%20child.PROCESSING_INSTRUCTION_NODE%0A%09%09%09%09%09%26%26%20child.data.substr%280%2C%20mark.length%29%20%3D%3D%20mark%0A%09%09%09%09%29%20%7B%0A%09%09%09%09%09document.removeChild%28child%29%3B%0A%09%09%09%09%09break%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%7D%2C%0A%09%09shadow%3A%20function%28document%2C%20style%29%20%7B%0A%09%09%09var%20sr%20%3D%20document.documentElement.shadowRoot%20%7C%7C%20null%3B%0A%09%09%09if%28%21sr%20%7C%7C%20this.btnPos%20%21%3D%202%29%20%7B%0A%09%09%09%09return%20%28this.shadow%20%3D%20function%28document%2C%20style%29%20%7B%0A%09%09%09%09%09return%20style%20%3D%3D%3D%20undefined%20%3F%20document%20%3A%20false%3B%0A%09%09%09%09%7D%29%28document%2C%20style%29%3B%0A%09%09%09%7D%0A%0A%09%09%09//%20Firefox%2071+%0A%09%09%09if%28style%20%3D%3D%3D%20undefined%29%0A%09%09%09%09return%20sr%3B%0A%09%09%09var%20st%20%3D%20sr.querySelector%28%22style%22%29%3B%0A%09%09%09var%20id%20%3D%20this.styleId%3B%0A%09%09%09if%28style%29%20%7B%0A%09%09%09%09st.append%28style%29%3B%0A%09%09%09%09st%5Bid%5D%20%3D%20st.lastChild%3B%0A%09%09%09%7D%0A%09%09%09else%20if%28id%20in%20st%29%20%7B%0A%09%09%09%09st%5Bid%5D.remove%28%29%3B%0A%09%09%09%09delete%20st%5Bid%5D%3B%0A%09%09%09%7D%0A%09%09%09return%20true%3B%0A%09%09%7D%2C%0A%09%09getXulWin%3A%20function%28window%29%20%7B%0A%09%09%09var%20docShell%20%3D%20%22QueryInterface%22%20in%20window%0A%09%09%09%09%3F%20window.QueryInterface%28Components.interfaces.nsIInterfaceRequestor%29%0A%09%09%09%09%09.getInterface%28Components.interfaces.nsIWebNavigation%29%0A%09%09%09%09%09.QueryInterface%28Components.interfaces.nsIDocShellTreeItem%29%0A%09%09%09%09%3A%20window.docShell%3B%20//%20Firefox%2070+%0A%09%09%09return%20docShell%0A%09%09%09%09.treeOwner%0A%09%09%09%09.QueryInterface%28Components.interfaces.nsIInterfaceRequestor%29%0A%09%09%09%09.getInterface%28%0A%09%09%09%09%09Components.interfaces.nsIXULWindow%0A%09%09%09%09%09%7C%7C%20Components.interfaces.nsIAppWindow%20//%20Firefox%2072+%0A%09%09%09%09%29%3B%0A%09%09%7D%2C%0A%09%09setOnTop%3A%20function%28btn%2C%20toggle%29%20%7B%0A%09%09%09var%20document%20%3D%20btn.ownerDocument%3B%0A%09%09%09var%20root%20%3D%20document.documentElement%3B%0A%09%09%09var%20onTop%20%3D%20root.getAttribute%28this.onTopAttr%29%20%3D%3D%20%22true%22%3B%0A%09%09%09if%28toggle%29%20%7B%0A%09%09%09%09onTop%20%3D%20%21onTop%3B%0A%09%09%09%09root.setAttribute%28this.onTopAttr%2C%20onTop%29%3B%0A%09%09%09%09if%28root.id%29%20%7B%0A%09%09%09%09%09if%28%22persist%22%20in%20document%29%0A%09%09%09%09%09%09document.persist%28root.id%2C%20this.onTopAttr%29%3B%0A%09%09%09%09%09else%20//%20Firefox%2063+%0A%09%09%09%09%09%09Services.xulStore.persist%28root%2C%20this.onTopAttr%29%3B%0A%09%09%09%09%7D%0A%09%09%09%7D%0A%09%09%09else%20if%28%21onTop%29%20//%20Just%20opened%20or%20restored%20window%20always%20have%20zLevel%20%3D%3D%20normalZ%0A%09%09%09%09return%3B%0A%09%09%09var%20window%20%3D%20document.defaultView%3B%0A%09%09%09var%20state%20%3D%20window.windowState%3B%0A%09%09%09//%20Strange%20glitches%20with%20minimized%20%22raisedZ%22%20window...%0A%09%09%09var%20restore%20%3D%20onTop%20%26%26%20state%20%3D%3D%20window.STATE_MINIMIZED%3B%0A%09%09%09if%28restore%20%7C%7C%20state%20%3D%3D%20window.STATE_NORMAL%29%20%7B%0A%09%09%09%09if%28restore%29%0A%09%09%09%09%09onTop%20%3D%20false%3B%0A%09%09%09%09let%20xulWin%20%3D%20this.getXulWin%28window%29%3B%0A%09%09%09%09xulWin.zLevel%20%3D%20onTop%20%3F%20xulWin.raisedZ%20%3A%20xulWin.normalZ%3B%0A%09%09%09%09//LOG%28%22Set%20on%20top%3A%20%22%20+%20onTop%29%3B%0A%09%09%09%7D%0A%09%09%09this.checkButton%28btn%2C%20onTop%29%3B%0A%09%09%7D%2C%0A%09%09toggleOnTop%3A%20function%28window%29%20%7B%0A%09%09%09this.setOnTop%28this.shadow%28window.document%29.getElementById%28this.btnId%29%2C%20true%29%3B%0A%09%09%7D%2C%0A%09%09checkButton%3A%20function%28btn%2C%20onTop%29%20%7B%0A%09%09%09btn.setAttribute%28this.onTopAttr%2C%20onTop%29%3B%0A%09%09%09this.btnChecked%20%26%26%20btn.setAttribute%28%22checked%22%2C%20onTop%29%3B%0A%09%09%7D%0A%09%7D%3B%0A%09storage.set%28watcherId%2C%20watcher%29%3B%0A%09watcher.init%28watcher.REASON_STARTUP%29%3B%0A%7D%0Afunction%20destructor%28reason%29%20%7B%0A%09if%28reason%20%3D%3D%20%22update%22%20%7C%7C%20reason%20%3D%3D%20%22delete%22%29%20%7B%0A%09%09watcher.destroy%28watcher.REASON_SHUTDOWN%29%3B%0A%09%09storage.set%28watcherId%2C%20null%29%3B%0A%09%7D%0A%7D%0Aif%28%0A%09typeof%20addDestructor%20%3D%3D%20%22function%22%20//%20Custom%20Buttons%200.0.5.6pre4+%0A%09%26%26%20addDestructor%20%21%3D%20%28%22addDestructor%22%20in%20window%20%26%26%20window.addDestructor%29%0A%29%0A%09addDestructor%28destructor%2C%20this%29%3B%0Aelse%0A%09this.onDestroy%20%3D%20destructor%3B%5D%5D%3E%3C/initcode%3E%0A%20%20%3Ccode%3E%3C%21%5BCDATA%5B/*CODE*/%5D%5D%3E%3C/code%3E%0A%20%20%3Caccelkey%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/accelkey%3E%0A%20%20%3Chelp%3E%3C%21%5BCDATA%5B%5D%5D%3E%3C/help%3E%0A%20%20%3Cattributes/%3E%0A%3C/custombutton%3E"
>Install</a>
| <a href="https://github.com/Infocatcher/Custom_Buttons/tree/master/CB_Editor_Toggle_on_Top">Source</a>
| <a href="https://github.com/Infocatcher/Custom_Buttons#usage">Instructions</a>
<script type="text/javascript">
var a = document.getElementsByTagName("a")[0];
a.title = document.title;
if(/%3Cimage%3E%3C%21%5BCDATA%5B(data%3A\S+)%5D%5D%3E%3C\/image%3E/.test(a.href)) {
	var icon = decodeURIComponent(RegExp.$1);

	var img = document.createElement("img");
	img.src = icon;
	img.alt = "";
	img.style.verticalAlign = "middle";
	img.style.marginRight = "4px";
	img.style.border = "none";
	a.insertBefore(img, a.firstChild);

	var link = document.createElement("link");
	link.rel = "shortcut icon";
	link.href = icon;
	document.documentElement.insertBefore(link, document.documentElement.firstChild);
}
</script>
<script type="text/javascript" src="https://infocatcher.github.io/Custom_Buttons/viewCustomButton.js"></script>
<script type="text/javascript">
if("viewCustomButtonCode" in window) setTimeout(function() {
	viewCustomButtonCode(a.href);
}, 0);
</script>
</body>